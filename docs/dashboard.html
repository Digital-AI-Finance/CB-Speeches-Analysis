<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CB Speeches Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        :root { --primary: #0072B2; --secondary: #D55E00; --bg: #fff; --bg-alt: #f8fafc; --text: #1e293b; --border: #e2e8f0; }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: system-ui, sans-serif; font-size: 12px; background: var(--bg); color: var(--text); line-height: 1.35; }
        header { background: linear-gradient(135deg, var(--primary), #005a8c); color: white; padding: 12px; text-align: center; }
        header h1 { font-size: 1.2rem; margin-bottom: 2px; }
        header p { opacity: 0.9; font-size: 0.8rem; }
        .badge { display: inline-block; background: #f59e0b; color: #000; padding: 1px 6px; border-radius: 8px; font-size: 0.7rem; font-weight: 600; margin: 6px 2px 0; }
        main { max-width: 1400px; margin: 0 auto; padding: 10px; }
        section { background: var(--bg); border: 1px solid var(--border); border-radius: 4px; margin-bottom: 10px; overflow: hidden; }
        .section-header { background: var(--bg-alt); padding: 8px 12px; border-bottom: 1px solid var(--border); cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
        .section-header h2 { font-size: 0.95rem; color: var(--primary); }
        .section-content { padding: 10px; }
        .collapsible { display: block; }
        .collapsed { display: none; }
        .mermaid { text-align: center; margin: 6px 0; font-size: 11px; }
        table { width: 100%; border-collapse: collapse; margin: 6px 0; font-size: 0.85rem; }
        th, td { padding: 5px 8px; text-align: left; border-bottom: 1px solid var(--border); }
        th { background: var(--bg-alt); font-weight: 600; }
        .chart-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(420px, 1fr)); gap: 8px; }
        .chart-card { border: 1px solid var(--border); border-radius: 4px; overflow: hidden; }
        .chart-card h3 { background: var(--bg-alt); padding: 6px 10px; font-size: 0.8rem; border-bottom: 1px solid var(--border); }
        .chart-card img { width: 100%; height: auto; display: block; }
        .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px; }
        .stat-card { background: var(--bg-alt); padding: 8px; border-radius: 4px; text-align: center; }
        .stat-value { font-size: 1.2rem; font-weight: 700; color: var(--primary); }
        .stat-label { font-size: 0.7rem; color: #64748b; }
        .highlight { background: #fef3c7; padding: 8px; border-radius: 4px; border-left: 3px solid #f59e0b; margin: 6px 0; font-size: 0.85rem; }
        footer { text-align: center; padding: 12px; color: #64748b; font-size: 0.75rem; }
        footer a { color: var(--primary); }
        .toggle { font-size: 1rem; }
        h3 { margin-top: 10px; font-size: 0.85rem; color: var(--primary); }
        @media (max-width: 768px) { .chart-grid { grid-template-columns: 1fr; } .stats-grid { grid-template-columns: repeat(2, 1fr); } }
    </style>
</head>
<body>
    <header>
        <h1>CB Speeches Analysis Dashboard</h1>
        <p>Central Bank Speech Sentiment vs Macroeconomic Indices</p>
        <span class="badge">SNSF</span><span class="badge">1996-2025</span>
    </header>
    <main>
        <section>
            <div class="section-header"><h2>Key Finding</h2></div>
            <div class="section-content">
                <div class="highlight"><strong>Near-Zero Correlation (r = 0.005):</strong> Speech sentiment does not systematically track macroeconomic conditions.</div>
                <div class="stats-grid">
                    <div class="stat-card"><div class="stat-value">0.005</div><div class="stat-label">Macro-Hawkish Corr</div></div>
                    <div class="stat-card"><div class="stat-value">72%</div><div class="stat-label">Variance (2 PCs)</div></div>
                    <div class="stat-card"><div class="stat-value">8</div><div class="stat-label">Macro Breaks</div></div>
                    <div class="stat-card"><div class="stat-value">12</div><div class="stat-label">Inflation Breaks</div></div>
                </div>
            </div>
        </section>
        <section>
            <div class="section-header" onclick="toggleSection(this)"><h2>Pipeline Architecture</h2><span class="toggle">+</span></div>
            <div class="section-content collapsed">
                <div class="mermaid">
flowchart TB
    subgraph Inputs["Input Data"]
        A["macro_data.csv"]
        B["speeches.parquet"]
    end
    subgraph Macro["Macro Analysis"]
        C["Rolling Std (12m)"]
        D["PCA (PC1, PC2)"]
        E["PELT Breakpoints"]
    end
    subgraph Sentiment["Sentiment"]
        F["Filter US (2,421)"]
        G["Monthly Aggregation"]
    end
    subgraph Results["Results"]
        H["Rolling Regression (36m)"]
        I["Correlation Analysis"]
    end
    A --> C --> D --> E
    D --> H
    B --> F --> G --> H --> I
                </div>
            </div>
        </section>
        <section>
            <div class="section-header" onclick="toggleSection(this)"><h2>FRED Series</h2><span class="toggle">+</span></div>
            <div class="section-content collapsed">
                <table>
                    <tr><th>Series</th><th>Name</th><th>Description</th></tr>
                    <tr><td>FEDFUNDS</td><td>Fed Funds Rate</td><td>Federal funds effective rate (%)</td></tr>
                    <tr><td>CPIAUCNS</td><td>CPI</td><td>Consumer Price Index</td></tr>
                    <tr><td>PPIACO</td><td>PPI</td><td>Producer Price Index</td></tr>
                    <tr><td>GDP</td><td>GDP</td><td>Gross Domestic Product</td></tr>
                    <tr><td>UNRATE</td><td>Unemployment</td><td>Unemployment Rate (%)</td></tr>
                    <tr><td>PAYEMS</td><td>Nonfarm Payrolls</td><td>Total Nonfarm Employment</td></tr>
                </table>
            </div>
        </section>
        <section>
            <div class="section-header" onclick="toggleSection(this)"><h2>PCA Variance</h2><span class="toggle">+</span></div>
            <div class="section-content collapsed">
                <table>
                    <tr><th>Component</th><th>Variance</th><th>Cumulative</th><th>Interpretation</th></tr>
                    <tr><td>PC1</td><td>48.6%</td><td>48.6%</td><td>Macro Strength Index</td></tr>
                    <tr><td>PC2</td><td>23.2%</td><td>71.8%</td><td>Inflation Index</td></tr>
                    <tr><td>PC3</td><td>15.4%</td><td>87.1%</td><td>-</td></tr>
                </table>
            </div>
        </section>
        <section>
            <div class="section-header" onclick="toggleSection(this)"><h2>Breakpoints (PELT)</h2><span class="toggle">+</span></div>
            <div class="section-content collapsed">
                <h3>Macro Index (8 breakpoints)</h3>
                <table><tr><th>#</th><th>Date</th></tr><tr><td>1</td><td>2001-01</td></tr><tr><td>2</td><td>2003-12</td></tr><tr><td>3</td><td>2007-04</td></tr><tr><td>4</td><td>2010-03</td></tr><tr><td>5</td><td>2016-11</td></tr><tr><td>6</td><td>2019-05</td></tr><tr><td>7</td><td>2021-06</td></tr><tr><td>8</td><td>2023-07</td></tr></table>
                <h3>Inflation Index (12 breakpoints)</h3>
                <table><tr><th>#</th><th>Date</th></tr><tr><td>1</td><td>1999-05</td></tr><tr><td>2</td><td>2001-06</td></tr><tr><td>3</td><td>2002-04</td></tr><tr><td>4</td><td>2004-05</td></tr><tr><td>5</td><td>2007-04</td></tr><tr><td>6</td><td>2008-07</td></tr><tr><td>7</td><td>2014-10</td></tr><tr><td>8</td><td>2016-06</td></tr><tr><td>9</td><td>2018-07</td></tr><tr><td>10</td><td>2020-08</td></tr><tr><td>11</td><td>2022-09</td></tr><tr><td>12</td><td>2023-12</td></tr></table>
            </div>
        </section>
        <section>
            <div class="section-header"><h2>All 12 Charts</h2></div>
            <div class="section-content">
                <div class="chart-grid">
                    <div class="chart-card"><h3>1. Rolling-Standardized Macro Variables</h3><img src="figures/01_scaled_macro_timeseries.png" alt="Chart 1" loading="lazy"></div>
                    <div class="chart-card"><h3>2. Principal Components</h3><img src="figures/02_principal_components.png" alt="Chart 2" loading="lazy"></div>
                    <div class="chart-card"><h3>3. Macro Index Breakpoints</h3><img src="figures/03_macro_strength_breakpoints.png" alt="Chart 3" loading="lazy"></div>
                    <div class="chart-card"><h3>4. Inflation Index Breakpoints</h3><img src="figures/04_inflation_index_breakpoints.png" alt="Chart 4" loading="lazy"></div>
                    <div class="chart-card"><h3>5. Speech Volume</h3><img src="figures/05_speech_count_distribution.png" alt="Chart 5" loading="lazy"></div>
                    <div class="chart-card"><h3>6. Inflation vs Sentiment</h3><img src="figures/06_inflation_sentiment_combined.png" alt="Chart 6" loading="lazy"></div>
                    <div class="chart-card"><h3>7. Rolling Betas (Macro)</h3><img src="figures/07_rolling_betas_macro.png" alt="Chart 7" loading="lazy"></div>
                    <div class="chart-card"><h3>8. Rolling R2 (Macro)</h3><img src="figures/08_rolling_r2_macro.png" alt="Chart 8" loading="lazy"></div>
                    <div class="chart-card"><h3>9. Rolling Betas (Inflation)</h3><img src="figures/09_rolling_betas_inflation.png" alt="Chart 9" loading="lazy"></div>
                    <div class="chart-card"><h3>10. Rolling R2 (Inflation)</h3><img src="figures/10_rolling_r2_inflation.png" alt="Chart 10" loading="lazy"></div>
                    <div class="chart-card"><h3>11. Correlation Matrix</h3><img src="figures/11_correlation_matrix.png" alt="Chart 11" loading="lazy"></div>
                    <div class="chart-card"><h3>12. PCA Loadings</h3><img src="figures/12_pca_loadings_heatmap.png" alt="Chart 12" loading="lazy"></div>
                </div>
            </div>
        </section>
    </main>
    <footer>
        <p><a href="https://github.com/Digital-AI-Finance/CB-Speeches-Analysis">GitHub</a> | SNSF Grant IZCOZ0_213370</p>
    </footer>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
        function toggleSection(header) {
            const content = header.nextElementSibling;
            const toggle = header.querySelector('.toggle');
            if (content.classList.contains('collapsed')) { content.classList.remove('collapsed'); toggle.textContent = '-'; }
            else { content.classList.add('collapsed'); toggle.textContent = '+'; }
        }
    </script>
</body>
</html>
